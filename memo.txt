# react-resizable-panels v4 対応修正

## 問題
react-resizable-panels がバージョン4.xにアップデートされた際にAPIが変更され、レイアウトが壊れていた。

## 原因
1. `direction` プロパティが `orientation` に名前変更された
2. `autoSaveId` プロパティが廃止され、`useDefaultLayout` フックに置き換えられた

## 修正内容

### 1. ResizableLayout.tsx

変更前:
- direction="horizontal"
- autoSaveId="editor-main-layout"
- defaultSize={20}, minSize={10}

変更後:
- orientation="horizontal"
- useDefaultLayout フックでレイアウト保存・復元
- defaultSize="20%", minSize="150px" (明示的な単位指定)

### 2. SidebarGroup.tsx

変更前:
- direction="vertical"
- autoSaveId プロパティ
- minSize={10}

変更後:
- orientation="vertical"
- useDefaultLayout フックでレイアウト保存・復元
- minSize="50px" (明示的な単位指定)
- storageId プロパティを追加

### 3. ToolbarButton.tsx

- whitespace-nowrap を追加（テキストの折り返し防止）

### 4. EditorToolbar.tsx

- flex-shrink-0 overflow-x-auto を追加（ツールバーの縮小防止とスクロール対応）

## react-resizable-panels v4 の新しいAPI

### useDefaultLayout フックの使い方

```tsx
import { Group, Panel, Separator, useDefaultLayout } from "react-resizable-panels";

function ResizableLayout() {
  const { defaultLayout, onLayoutChange } = useDefaultLayout({
    id: "unique-layout-id",    // 一意のID（必須）
    storage: localStorage,      // localStorage または sessionStorage
    debounceSaveMs: 100,        // 保存のデバウンス（デフォルト100ms）
  });

  return (
    <Group
      orientation="horizontal"
      defaultLayout={defaultLayout}      // 保存されたレイアウトを復元
      onLayoutChange={onLayoutChange}    // レイアウト変更時に保存
    >
      <Panel id="left" defaultSize="20%">左パネル</Panel>
      <Separator />
      <Panel id="center">中央パネル</Panel>
    </Group>
  );
}
```

## 保存されるレイアウトID

| ID                     | 内容                                 |
|------------------------|--------------------------------------|
| editor-main-layout     | メインの3分割レイアウト（左/中央/右）|
| editor-left-sidebar    | 左サイドバー内の縦分割               |
| editor-right-sidebar   | 右サイドバー内の縦分割               |

## 注意事項

- LocalStorageに古いレイアウトデータが残っている場合、表示が崩れることがある
- その場合は DevTools > Application > Local Storage からデータをクリアする

